{% assign pubs = include.pubs| default: site.data.publications %}

<ul class="pub-list">
  {% for pub in pubs %}
  <li class="pub-item">

    <h3 class="pub-title">
      <a href="{{ pub.url }}" target="_blank" rel="noopener">{{ pub.title }}</a>
    </h3>
    <div class="pub-meta">
      <span class="pub-authors">{{ pub.authors }}</span>
    </div>
    <div class="pub-venue">
      <strong><span class="pub-venue">{{ pub.venue }} | {{ pub.year }}</span></strong>
    </div>

    <div class="pub-links">
      {% if pub.pdf %}
        <a href="{{ pub.pdf }}" class="icon-link" aria-label="PDF"><i class="fas fa-file-lines"></i></a>
      {% endif %}
      {% if pub.video %}
        <a href="{{ pub.video }}" class="icon-link" aria-label="Video"><i class="fas fa-video"></i></a>
      {% endif %}
      {% if pub.poster %}
        <a href="{{ pub.poster }}" class="icon-link" aria-label="Poster"><i class="fas fa-person-chalkboard"></i></a>
      {% endif %}
      {% if pub.slides %}
        <a href="{{ pub.slides }}" class="icon-link" aria-label="Slides"><i class="fab fa-file-powerpoint"></i></a>
      {% endif %}
      {% if pub.bibtex %}
        <button class="copy-bib" data-bib="{{ pub.bibtex | escape }}"><i class="fas fa-copy"></i>BibTeX</button>
      {% endif %}
    </div>
  </li>
  {% endfor %}
</ul>

<script>
document.addEventListener('click', (e) => {
  // Accept clicks on the <i> icon *or* the surrounding button
  const btn = e.target.closest('.copy-bib');
  if (!btn) return;

  const bib = btn.dataset.bib.replace(/&quot;/g, '"');

  navigator.clipboard.writeText(bib).then(() => {
    const originalHTML = btn.innerHTML;          // <-- keep icon + label
    btn.innerHTML = '<i class="fas fa-check"></i> Copied!';  // âœ” icon
    btn.classList.add('copied');                 // optional colour change

    setTimeout(() => {
      btn.innerHTML = originalHTML;              // restore icon + label
      btn.classList.remove('copied');
    }, 1500);
  });
});
</script>
